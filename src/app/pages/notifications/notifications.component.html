    <div class="pt-dialog">
      <div class="pt-dialog-head" mat-dialog-title>
        <span>Notifications</span>
        <span style="flex: 1 1 auto"></span>
        <button mat-icon-button (click)="close()" aria-label="Close notifications">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <div mat-dialog-content class="pt-dialog-content">
        <div class="pt-row" style="margin: 10px 0 18px; align-items:center">
          <span class="pt-muted" *ngIf="!loading">{{ unreadCount }} unread</span>
          <span style="flex: 1 1 auto"></span>
          <button mat-stroked-button color="primary" (click)="reload()" [disabled]="loading">
            <mat-icon>refresh</mat-icon>
            Refresh
          </button>
          <button mat-raised-button color="primary" (click)="markAllRead()" [disabled]="loading || !unreadCount">
            Mark all read
          </button>
        </div>

        <form class="pt-filter-row" [formGroup]="filterForm" (ngSubmit)="applyFilters()">
          <mat-form-field appearance="outline">
            <mat-label>Read state</mat-label>
            <mat-select formControlName="readState">
              <mat-option value="all">All</mat-option>
              <mat-option value="unread">Unread</mat-option>
              <mat-option value="read">Read</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Level</mat-label>
            <mat-select formControlName="levels" multiple>
              <mat-option value="INFO">Info</mat-option>
              <mat-option value="SUCCESS">Success</mat-option>
              <mat-option value="WARNING">Warning</mat-option>
              <mat-option value="ERROR">Error</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>From</mat-label>
            <input matInput type="date" formControlName="created_from" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>To</mat-label>
            <input matInput type="date" formControlName="created_to" />
          </mat-form-field>

          <div class="pt-filter-actions">
            <button mat-raised-button color="primary" type="submit">Apply</button>
            <button mat-button type="button" (click)="resetFilters()">Reset</button>
          </div>
        </form>

        <div *ngIf="loading" class="pt-row" style="gap:12px; align-items:center">
          <span>No data available</span>
        </div>

        <div *ngIf="!loading && notifications.length === 0" class="pt-muted">No notifications.</div>

        <div *ngFor="let n of notifications" class="pt-notification" [class.is-unread]="!n.is_read">
          <div style="display:flex; gap: 12px; align-items:flex-start">
            <mat-chip class="pt-chip" [class.unread]="!n.is_read">{{ n.level }}</mat-chip>
            <div style="flex: 1 1 auto">
              <div style="display:flex; gap: 10px; align-items: baseline; flex-wrap: wrap">
                <div class="pt-title">{{ n.title }}</div>
                <div class="pt-muted">{{ n.created_at | date: 'medium' }}</div>
              </div>
              <div class="pt-body" *ngIf="n.body">{{ n.body }}</div>
              <div class="pt-row" style="margin-top: 10px; gap: 8px; flex-wrap: wrap">
                <button
                  mat-button
                  color="primary"
                  type="button"
                  (click)="openNotification(n)"
                  *ngIf="notificationRoute(n) || n.link"
                >
                  Open
                </button>
                <button mat-button color="primary" (click)="markRead(n)" [disabled]="n.is_read">
                  Mark read
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="pt-pagination" *ngIf="!loading && total">
          <span class="pt-muted">Page {{ page }}  â€¢  {{ total }} total</span>
          <span style="flex: 1 1 auto"></span>
          <mat-form-field appearance="outline" class="pt-page-size">
            <mat-label>Page size</mat-label>
            <mat-select [value]="pageSize" (selectionChange)="updatePageSize($event.value)">
              <mat-option [value]="5">5</mat-option>
              <mat-option [value]="10">10</mat-option>
              <mat-option [value]="25">25</mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-stroked-button color="primary" (click)="prevPage()" [disabled]="!hasPrev">Prev</button>
          <button mat-stroked-button color="primary" (click)="nextPage()" [disabled]="!hasNext">Next</button>
        </div>
      </div>
    </div>
  
